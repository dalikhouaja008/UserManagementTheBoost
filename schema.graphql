# ------------------------------------------------------
# THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
# ------------------------------------------------------

type Permission {
  resource: Resource!
  actions: [Action!]!
}

"""Resources disponibles dans le service user-management"""
enum Resource {
  USERS
  SETTINGS
  ROLES
  AUTHENTICATION
  AUTH
}

"""Type de permission"""
enum Action {
  read
  create
  update
  delete
}

type Role {
  name: String!
  permissions: [Permission!]!
}

type User {
  _id: ID!

  """Nom d'utilisateur"""
  username: String!

  """Adresse e-mail de l'utilisateur"""
  email: String!

  """Mot de passe de l'utilisateur"""
  password: String!

  """Secret pour l'authentification à deux facteurs"""
  twoFactorSecret: String

  """Indique si l'utilisateur a activé l'authentification à deux facteurs"""
  isTwoFactorEnabled: Boolean!

  """Clé publique de la wallet de l'utilisateur"""
  publicKey: String

  """Rôle de l'utilisateur (par exemple, 'user', 'admin')"""
  role: String

  """Indique si l'utilisateur est vérifié"""
  isVerified: Boolean!

  """Date de création du compte"""
  createdAt: DateTime!

  """Date de mise à jour du compte"""
  updatedAt: DateTime!
}

"""
A date-time string at UTC, such as 2019-12-03T09:54:33Z, compliant with the date-time format.
"""
scalar DateTime

type LoginResponse {
  """JWT Access Token"""
  accessToken: String

  """JWT Refresh Token"""
  refreshToken: String

  """Indique si la 2FA est requise"""
  requiresTwoFactor: Boolean!

  """token générer lors de la validation 2FA"""
  tempToken: String

  """Informations de l'utilisateur"""
  user: User
}

type Query {
  validateUser(userId: String!): User!
  roles: [Role!]!
  role(name: String!): Role!
  getRolePermissions(name: String!): [Permission!]!
}

type Mutation {
  signUp(signupData: UserInput!): User!
  createSpecialUser(input: UserInput!): User!
  login(credentials: LoginInput!): LoginResponse!
  refreshTokens(refreshTokenData: RefreshTokenInput!): String!
  changePassword(changePasswordData: ChangePasswordInput!): String!
  forgotPassword(forgotPasswordData: ForgotPasswordInput!): String!
  requestReset(email: String!): String!
  verifyCode(email: String!, code: String!): String!
  resetPassword(resetPasswordData: ResetPasswordInput!): User!
  enableTwoFactorAuth: String!
  verifyTwoFactorAuth(token: String!): Boolean!
  verifyTwoFactorLogin(token: String!): LoginResponse!
  createRole(createRoleInput: CreateRoleInput!): Role!
  updateRole(updateRoleInput: UpdateRoleInput!): Role!
  deleteRole(name: String!): Boolean!
}

input UserInput {
  """Nom d'utilisateur"""
  username: String!

  """Adresse e-mail de l'utilisateur"""
  email: String!

  """Mot de passe de l'utilisateur"""
  password: String!

  """Rôle de l'utilisateur (par exemple, 'user', 'admin')"""
  role: String

  """Clé publique de la wallet de l'utilisateur"""
  publicKey: String

  """Secret pour l'authentification à deux facteurs"""
  twoFactorSecret: String

  """Indique si l'utilisateur est vérifié"""
  isVerified: Boolean! = false
}

input LoginInput {
  email: String!
  password: String!
}

input RefreshTokenInput {
  refreshToken: String!
}

input ChangePasswordInput {
  userId: String!
  oldPassword: String!
  newPassword: String!
}

input ForgotPasswordInput {
  email: String!
}

input ResetPasswordInput {
  email: String!
  code: String!
  newPassword: String!
}

input CreateRoleInput {
  name: String!
  permissions: [PermissionInput!]!
}

input PermissionInput {
  resource: Resource!
  actions: [Action!]!
}

input UpdateRoleInput {
  name: String!
  permissions: [PermissionInput!]!
}